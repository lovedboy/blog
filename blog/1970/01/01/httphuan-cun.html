<!DOCTYPE html>
<html lang="en">
<head>
          <title></title>
	    <link href='https://lovedboy.github.io/theme/css/notsobad.css' rel='stylesheet' type='text/css'>


        <meta charset="utf-8" />
        <link href="https://lovedboy.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title=" Full Atom Feed" />
        <link href="https://lovedboy.github.io/feeds/misc.atom.xml" type="application/atom+xml" rel="alternate" title=" Categories Atom Feed" />




</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://lovedboy.github.io/"> <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/">home</a></li>
            <li><a href="/">links</a></li>
            <li><a href="/">about</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://lovedboy.github.io/blog/1970/01/01/httphuan-cun.html" rel="bookmark"
         title="Permalink to http缓存">http缓存</a>
		 
    <abbr class="published" title="1970-01-01T00:00:00+08:00">
      1970-01-01 00:00
    </abbr>
		 </h2>
 
  </header>
    <div class="entry-content">
    <h3>ETag</h3>
<p>服务器生成并返回一个随机Etag，通常是文件内容的哈希值或者某个其他指纹码。客户端不必了解指纹码是如何生成的，只需要在下一个请求中将其发送给服务器：如果指纹码仍然一致，说明资源未被修改，服务器可以直接返回304从而让客户端跳过下载。</p>
<p>服务器返回的Etag是 <em>1507311446</em>   状态码是200</p>
<p><img alt="etag1" src="http://ww3.sinaimg.cn/large/79565610gw1eulyjirfsdj21800c7acp.jpg"></p>
<p>刷新页面，浏览器if-None-Match带的上次服务器返回的Etag <em>1507311446</em> ，服务器生成的Etag还是这个，直接返回304给浏览器。</p>
<p><img alt="etag2" src="http://ww2.sinaimg.cn/large/79565610gw1eulyjuauefj217p0bldic.jpg"></p>
<h3>Cache-Control</h3>
<p>Etag是弊端是每次都要向服务器发送请求。最好是不与服务器进行通信的请求：通过响应的本地副本，避免所有的网络延迟以及数据传输的数据成本。
这就是Cache-Control的作用。Cache-Control有很多设置，具体可以谷歌下。</p>
<p>第一次请求，服务器设置了Cache-Control:max-age=60，意思是：60S内可以取本地副本。</p>
<p><img alt="cache-control1" src="http://ww1.sinaimg.cn/large/79565610gw1eulz8zh9dej218n0cgmzt.jpg"></p>
<p>新建标签页再次请求，可以看到<em>from cache</em> 字样。注意：如果使用的是刷新，浏览器会无视Cache-Control的设置继续向服务器请求。</p>
<p><img alt="cache-control2" src="http://ww3.sinaimg.cn/large/79565610gw1eulz9dc5vaj217g0di76e.jpg"></p>
<h3>Expires</h3>
<p>在HTTP 1.1已经被Cache-Control代替了。可以不用考虑了。</p>
<h3>Last-Modified</h3>
<p>和ETag类似，服务器给客户端一个资源的最后修改时间。客户端浏览器下次请求就会带上<code>If-Modified-Since</code>，就是上一次从服务器给的日期。服务器判断如果文件没有发生变更就返回304。</p>
<p>参考:</p>
<p><a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching?hl=zh-cn#cache-control">https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching?hl=zh-cn#cache-control</a></p>
<p><a href="http://www.cnblogs.com/kaima/archive/2009/10/13/1582337.html">http://www.cnblogs.com/kaima/archive/2009/10/13/1582337.html</a></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                By <a href="http://github.com/lovedboy" target="_blank">@lovedb0y</a>
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>